/*
select * from pv_session_memory_detail limit 2;
select * from pv_session_memory_context limit 2;
select * from pv_thread_memory_context limit 2;
*/
select * from DBE_PERF.local_threadpool_status limit 2;
 node_name | group_id | bind_numa_id | bind_cpu_number | listener |                       worker_info                        |             session_info              
-----------+----------+--------------+-----------------+----------+----------------------------------------------------------+---------------------------------------
 datanode1 |        0 |              |               0 |        1 | .*
 datanode1 |        1 |              |               0 |        1 | .*
(2 rows)

select * from DBE_PERF.global_threadpool_status limit 2;
 node_name | group_id | bind_numa_id | bind_cpu_number | listener |                       worker_info                        |             session_info              
-----------+----------+--------------+-----------------+----------+----------------------------------------------------------+---------------------------------------
 datanode1 |        0 |              |               0 |        1 | .*
 datanode1 |        1 |              |               0 |        1 | .*
(2 rows)

select * from pg_stat_activity order by sessionid limit 2;
 datid |  datname   |       pid       | sessionid | usesysid | usename | application_name | client_addr | client_hostname | client_port |            backend_start            |             xact_start              |             query_start             |            state_change             | waiting | enqueue | state  | resource_pool |    query_id     |                                  query                                  |                                                           connection_info                                                            
-------+------------+-----------------+-----------+----------+---------+------------------+-------------+-----------------+-------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+---------+---------+--------+---------------+-----------------+-------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------
 16384 | regression | .*
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode,                                                    +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         sum(case                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when o_orderpriority = '1-URGENT'                      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         or o_orderpriority = '2-HIGH'                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then 1                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) as high_line_count,                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         sum(case                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when o_orderpriority <> '1-URGENT'                     +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         and o_orderpriority <> '2-HIGH'                +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then 1                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) as low_line_count                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | from                                                                   +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         orders,                                                        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         lineitem                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | where                                                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         o_orderkey = l_orderkey                                        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipmode IN ('MAIL   ', 'SHIP   ')                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_commitdate < l_receiptdate                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate < l_commitdate                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_receiptdate >= date '1994-01-01'                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_receiptdate < date '1994-01-01' + interval '1 year'      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | group by                                                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode                                                     +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | order by                                                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode;                                                     | 
 16384 | regression | .*
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         100.00 * sum(case                                              +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when p_type like 'PROMO%'                              +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then l_extendedprice * (1 - l_discount)        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue+| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | from                                                                   +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         lineitem,                                                      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         part                                                           +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | where                                                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_partkey = p_partkey                                          +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate >= date '1995-09-01'                            +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate < date '1995-09-01' + interval '1 month'        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | ;                                                                       | 
(2 rows)

select * from pg_stat_activity_ng order by sessionid limit 2;
 datid |  datname   |       pid       | sessionid | usesysid | usename | application_name | client_addr | client_hostname | client_port |            backend_start            |             xact_start              |             query_start             |            state_change             | waiting | enqueue | state  | resource_pool |    query_id     |                                  query                                  |  node_group  
-------+------------+-----------------+-----------+----------+---------+------------------+-------------+-----------------+-------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+---------+---------+--------+---------------+-----------------+-------------------------------------------------------------------------+--------------
 16384 | regression | .*
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode,                                                    +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         sum(case                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when o_orderpriority = '1-URGENT'                      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         or o_orderpriority = '2-HIGH'                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then 1                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) as high_line_count,                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         sum(case                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when o_orderpriority <> '1-URGENT'                     +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         and o_orderpriority <> '2-HIGH'                +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then 1                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) as low_line_count                                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | from                                                                   +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         orders,                                                        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         lineitem                                                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | where                                                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         o_orderkey = l_orderkey                                        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipmode IN ('MAIL   ', 'SHIP   ')                       +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_commitdate < l_receiptdate                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate < l_commitdate                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_receiptdate >= date '1994-01-01'                         +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_receiptdate < date '1994-01-01' + interval '1 year'      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | group by                                                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode                                                     +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | order by                                                               +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_shipmode;                                                     | 
 16384 | regression | .*
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         100.00 * sum(case                                              +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 when p_type like 'PROMO%'                              +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                         then l_extendedprice * (1 - l_discount)        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |                 else 0                                                 +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue+| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | from                                                                   +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         lineitem,                                                      +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         part                                                           +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | where                                                                  +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         l_partkey = p_partkey                                          +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate >= date '1995-09-01'                            +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 |         and l_shipdate < date '1995-09-01' + interval '1 month'        +| 
       |            |                 |           |          |         |                  |             |                 |             |                                     |                                     |                                     |                                     |         |         |        |               |                 | ;                                                                       | 
(2 rows)

select * from pg_session_wlmstat order by sessionid limit 2;
 datid |  datname   |    threadid     | sessionid | processid | usesysid | appname | usename | priority | attribute | block_time | elapsed_time | total_cpu_time | cpu_skew_percent | statement_mem | active_points | dop_value | control_group | status  | enqueue | resource_pool |                                  query                                  | is_plana |  node_group  
-------+------------+-----------------+-----------+-----------+----------+---------+---------+----------+-----------+------------+--------------+----------------+------------------+---------------+---------------+-----------+---------------+---------+---------+---------------+-------------------------------------------------------------------------+----------+--------------
 16384 | regression | .*
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         l_shipmode,                                                    +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         sum(case                                                       +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 when o_orderpriority = '1-URGENT'                      +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                         or o_orderpriority = '2-HIGH'                  +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                         then 1                                         +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 else 0                                                 +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         end) as high_line_count,                                       +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         sum(case                                                       +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 when o_orderpriority <> '1-URGENT'                     +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                         and o_orderpriority <> '2-HIGH'                +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                         then 1                                         +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 else 0                                                 +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         end) as low_line_count                                         +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | from                                                                   +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         orders,                                                        +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         lineitem                                                       +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | where                                                                  +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         o_orderkey = l_orderkey                                        +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_shipmode IN ('MAIL   ', 'SHIP   ')                       +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_commitdate < l_receiptdate                               +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_shipdate < l_commitdate                                  +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_receiptdate >= date '1994-01-01'                         +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_receiptdate < date '1994-01-01' + interval '1 year'      +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | group by                                                               +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         l_shipmode                                                     +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | order by                                                               +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         l_shipmode;                                                     |          | 
 16384 | regression | .*
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         100.00 * sum(case                                              +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 when p_type like 'PROMO%'                              +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                         then l_extendedprice * (1 - l_discount)        +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |                 else 0                                                 +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue+|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | from                                                                   +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         lineitem,                                                      +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         part                                                           +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | where                                                                  +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         l_partkey = p_partkey                                          +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_shipdate >= date '1995-09-01'                            +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               |         and l_shipdate < date '1995-09-01' + interval '1 month'        +|          | 
       |            |                 |           |           |          |         |         |          |           |            |              |                |                  |               |               |           |               |         |         |               | ;                                                                       |          | 
(2 rows)

select * from pg_thread_wait_status limit 2;
 node_name | db_name |    thread_name     | query_id |       tid       |    sessionid    | lwtid | psessionid | tlevel | smpid | wait_status | wait_event 
-----------+---------+--------------------+----------+-----------------+-----------------+-------+------------+--------+-------+-------------+------------
 datanode1 |         | ThreadPoolListener |        0 | .* 
 datanode1 |         | ThreadPoolListener |        0 | .* 
(2 rows)

select pg_current_sessid();
 pg_current_sessid 
-------------------
                21
(1 row)

